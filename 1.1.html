<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proekt.top - –ì–ª–∞–≤–Ω–∞—è</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #000;
            color: #ffeb3b;
            min-height: 100vh;
            line-height: 1.6;
        }

        /* –®–∞–ø–∫–∞ */
        .header {
            background-color: #111;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid #ffeb3b;
            box-shadow: 0 2px 10px rgba(255, 235, 59, 0.2);
        }

        .logo {
            font-size: 2rem;
            font-weight: bold;
            color: #ffeb3b;
            text-shadow: 0 0 10px rgba(255, 235, 59, 0.5);
            cursor: pointer;
        }

        .auth-buttons {
            display: flex;
            gap: 1rem;
        }

        .auth-buttons button {
            background-color: #ffeb3b;
            color: #000;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .auth-buttons button:hover {
            background-color: #ffd600;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(255, 235, 59, 0.3);
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .user-role {
            background-color: #333;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
        }

        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
        .nav-back {
            background-color: #111;
            padding: 1rem 2rem;
            border-bottom: 1px solid #333;
            display: none;
        }

        .nav-back button {
            background-color: transparent;
            color: #ffeb3b;
            border: 1px solid #ffeb3b;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .nav-back button:hover {
            background-color: #ffeb3b;
            color: #000;
        }

        /* –ö–æ–Ω—Ç–µ–Ω—Ç —Å—Ç—Ä–∞–Ω–∏—Ü */
        .page {
            display: none;
            padding: 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .page.active {
            display: block;
        }

        .page-header {
            margin-bottom: 2rem;
            text-align: center;
        }

        .page-header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        /* –°–µ—Ç–∫–∞ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ */
        .grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
        }

        .grid-item {
            background-color: #111;
            border: 2px solid #ffeb3b;
            border-radius: 12px;
            padding: 2rem;
            text-decoration: none;
            color: #ffeb3b;
            display: block;
            transition: all 0.3s ease;
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
            cursor: pointer;
        }

        .grid-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #ffeb3b, #000);
        }

        .grid-item:hover {
            background-color: #ffeb3b;
            color: #000;
            transform: translateY(-5px) scale(1.03);
            box-shadow: 0 8px 16px rgba(255, 235, 59, 0.3);
        }

        .item-content {
            text-align: center;
            z-index: 1;
        }

        .item-content h3 {
            margin-bottom: 0.5rem;
            font-size: 1.5rem;
        }

        .item-content p {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è */
        .calendar-container {
            background-color: #111;
            border: 2px solid #ffeb3b;
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .calendar-navigation {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .calendar-navigation button {
            background-color: #ffeb3b;
            color: #000;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
        }

        .calendar-theme-toggle {
            background-color: #ffeb3b;
            color: #000;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
        }

        .calendar-day {
            background-color: #222;
            border: 1px solid #333;
            padding: 1rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .calendar-day:hover {
            background-color: #ffeb3b;
            color: #000;
        }

        .calendar-day.has-event {
            background-color: #333;
            border-color: #ffeb3b;
        }

        .calendar-day-header {
            background-color: #333;
            font-weight: bold;
            padding: 0.5rem;
            text-align: center;
        }

        .calendar-actions {
            margin-top: 1rem;
            text-align: center;
        }

        .create-event-btn {
            background-color: #ffeb3b;
            color: #000;
            border: none;
            padding: 0.8rem 2rem;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .create-event-btn:hover {
            background-color: #ffd600;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(255, 235, 59, 0.3);
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –ø—Ä–æ–µ–∫—Ç–Ω–æ–π –¥–æ—Å–∫–∏ */
        .project-board {
            display: flex;
            gap: 1rem;
            overflow-x: auto;
            padding-bottom: 1rem;
        }

        .status-column {
            background-color: #111;
            border: 1px solid #ffeb3b;
            border-radius: 8px;
            padding: 1rem;
            min-width: 280px;
            flex-shrink: 0;
        }

        .status-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid #333;
        }

        .task {
            background-color: #222;
            border: 1px solid #333;
            border-radius: 6px;
            padding: 1rem;
            margin-bottom: 1rem;
            cursor: move;
            position: relative;
            transition: all 0.3s ease;
        }

        .task.dragging {
            opacity: 0.5;
            transform: scale(0.95);
        }

        .task:hover {
            border-color: #ffeb3b;
        }

        .task-date {
            position: absolute;
            bottom: 0.5rem;
            right: 0.5rem;
            font-size: 0.7rem;
            opacity: 0.7;
        }

        .add-task-btn {
            background-color: #ffeb3b;
            color: #000;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            margin-bottom: 1rem;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è —á–∞—Ç–∞ */
        .chat-container {
            background-color: #111;
            border: 2px solid #ffeb3b;
            border-radius: 12px;
            padding: 1rem;
            height: 500px;
            display: flex;
            flex-direction: column;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            margin-bottom: 1rem;
            padding: 1rem;
            background-color: #000;
            border-radius: 8px;
        }

        .message {
            background-color: #222;
            border-radius: 8px;
            padding: 0.8rem;
            margin-bottom: 0.5rem;
            border-left: 3px solid #ffeb3b;
        }

        .message-header {
            display: flex;
            justify-content: space-between;
            font-size: 0.8rem;
            margin-bottom: 0.3rem;
            opacity: 0.7;
        }

        .chat-input {
            display: flex;
            gap: 0.5rem;
        }

        .chat-input input {
            flex: 1;
            padding: 0.8rem;
            background-color: #111;
            border: 1px solid #ffeb3b;
            border-radius: 4px;
            color: #fff;
        }

        .chat-input button {
            background-color: #ffeb3b;
            color: #000;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–∞–±–∏–Ω–µ—Ç–∞ —Ö–æ—Å—Ç–∞ */
        .host-controls {
            background-color: #111;
            border: 2px solid #ffeb3b;
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .control-section {
            margin-bottom: 2rem;
        }

        .control-section h3 {
            margin-bottom: 1rem;
            color: #ffeb3b;
        }

        .user-list {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .user-card {
            background-color: #222;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .user-info-line {
            display: flex;
            align-items: center;
            gap: 1rem;
            flex: 1;
        }

        .user-actions {
            display: flex;
            gap: 0.5rem;
        }

        .user-actions button {
            background-color: #ffeb3b;
            color: #000;
            border: none;
            padding: 0.3rem 0.8rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
        }

        .role-select {
            background-color: #333;
            color: #ffeb3b;
            border: 1px solid #ffeb3b;
            padding: 0.3rem;
            border-radius: 4px;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ä–æ–ª–∏ */
        .role-selection {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .role-option {
            display: flex;
            align-items: center;
            padding: 0.8rem;
            background-color: #111;
            border: 1px solid #333;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .role-option:hover {
            background-color: #222;
            border-color: #ffeb3b;
        }

        .role-option.selected {
            background-color: #1a1a1a;
            border-color: #ffeb3b;
            box-shadow: 0 0 5px rgba(255, 235, 59, 0.3);
        }

        .role-radio {
            margin-right: 0.8rem;
            accent-color: #ffeb3b;
        }

        .role-info {
            flex: 1;
        }

        .role-name {
            font-weight: bold;
            color: #ffeb3b;
        }

        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background-color: #000;
            margin: 10% auto;
            padding: 2rem;
            border: 2px solid #ffeb3b;
            border-radius: 12px;
            width: 90%;
            max-width: 400px;
            position: relative;
            animation: modalAppear 0.3s ease-out;
        }

        @keyframes modalAppear {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .close {
            color: #ffeb3b;
            float: right;
            font-size: 2rem;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.3s;
        }

        .close:hover {
            color: #fff;
        }

        .modal-content h2 {
            margin-bottom: 1.5rem;
            text-align: center;
            color: #ffeb3b;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: #ffeb3b;
        }

        .modal-content input, .modal-content select, .modal-content textarea {
            width: 100%;
            padding: 0.8rem;
            background-color: #111;
            border: 1px solid #ffeb3b;
            border-radius: 4px;
            color: #fff;
            font-size: 1rem;
        }

        .modal-content input:focus, .modal-content select:focus, .modal-content textarea:focus {
            outline: none;
            border-color: #ffd600;
            box-shadow: 0 0 5px rgba(255, 235, 59, 0.5);
        }

        .modal-content button {
            width: 100%;
            padding: 0.8rem;
            margin-top: 1rem;
            background-color: #ffeb3b;
            color: #000;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .modal-content button:hover {
            background-color: #ffd600;
        }

        .message {
            margin-top: 1rem;
            text-align: center;
            min-height: 1.5rem;
        }

        .switch-form {
            text-align: center;
            margin-top: 1rem;
        }

        .switch-form a {
            color: #ffeb3b;
            cursor: pointer;
            text-decoration: underline;
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            .header {
                padding: 1rem;
                flex-direction: column;
                gap: 1rem;
            }
            
            .logo {
                font-size: 1.5rem;
            }
            
            .page {
                padding: 1rem;
            }
            
            .grid-container {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 1rem;
            }
            
            .grid-item {
                padding: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º –∏ –∫–Ω–æ–ø–∫–∞–º–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ -->
    <header class="header">
        <div class="logo" onclick="showPage('home')">Proekt.top</div>
        <div class="auth-section" id="authSection">
            <div class="auth-buttons">
                <button onclick="openRegisterModal()">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
                <button onclick="openLoginModal()">–í–æ–π—Ç–∏</button>
            </div>
        </div>
    </header>

    <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è –Ω–∞–∑–∞–¥ -->
    <div class="nav-back" id="navBack">
        <button onclick="showPage('home')">‚Üê –ù–∞–∑–∞–¥ –Ω–∞ –≥–ª–∞–≤–Ω—É—é</button>
    </div>

    <!-- –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ -->
    <div id="home-page" class="page active">
        <div class="grid-container">
            <!-- –ö–≤–∞–¥—Ä–∞—Ç 1: –ö–∞–ª–µ–Ω–¥–∞—Ä—å -->
            <div class="grid-item" onclick="showPage('calendar')">
                <div class="item-content">
                    <h3>üìÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å</h3>
                    <p>–ü–ª–∞–Ω–∏—Ä—É–π—Ç–µ –∑–∞–¥–∞—á–∏ –∏ —Å–æ–±—ã—Ç–∏—è</p>
                </div>
            </div>

            <!-- –ö–≤–∞–¥—Ä–∞—Ç 2: –ö–∞–±–∏–Ω–µ—Ç —Ö–æ—Å—Ç–∞ (–∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–∫—Ä—ã—Ç) -->
            <div class="grid-item host-only" id="hostCabinetLink" style="display: none;" onclick="showPage('host-cabinet')">
                <div class="item-content">
                    <h3>üëë –ö–∞–±–∏–Ω–µ—Ç –•–æ—Å—Ç–∞</h3>
                    <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–æ–ª—è–º–∏ –∏ –ø—Ä–æ–µ–∫—Ç–æ–º</p>
                </div>
            </div>

            <!-- –ö–≤–∞–¥—Ä–∞—Ç 3: –ü—Ä–æ–µ–∫—Ç–Ω–∞—è –¥–æ—Å–∫–∞ -->
            <div class="grid-item" onclick="showPage('project-board')">
                <div class="item-content">
                    <h3>üìã –ü—Ä–æ–µ–∫—Ç–Ω—ã–π –ü–ª–∞–Ω</h3>
                    <p>–î–æ—Å–∫–∞ –∑–∞–¥–∞—á –∏ —Å—Ç–∞—Ç—É—Å–æ–≤</p>
                </div>
            </div>

            <!-- –ö–≤–∞–¥—Ä–∞—Ç 4: –ß–∞—Ç -->
            <div class="grid-item" onclick="showPage('chat')">
                <div class="item-content">
                    <h3>üí¨ –°–≤—è–∑—å</h3>
                    <p>–û–±—â–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã</p>
                </div>
            </div>
        </div>
    </div>

    <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—è -->
    <div id="calendar-page" class="page">
        <div class="page-header">
            <h1>üìÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å</h1>
            <p>–ü–ª–∞–Ω–∏—Ä—É–π—Ç–µ –∑–∞–¥–∞—á–∏ –∏ —Å–æ–±—ã—Ç–∏—è</p>
        </div>
        
        <div class="calendar-container">
            <div class="calendar-header">
                <div class="calendar-navigation">
                    <button onclick="changeMonth(-1)">‚Üê –ü—Ä–µ–¥—ã–¥—É—â–∏–π</button>
                    <h2 id="currentMonth">–ú–∞—Ä—Ç 2024</h2>
                    <button onclick="changeMonth(1)">–°–ª–µ–¥—É—é—â–∏–π ‚Üí</button>
                </div>
                <button class="calendar-theme-toggle" onclick="toggleCalendarTheme()">–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –Ω–∞ —á–µ—Ä–Ω–æ-–±–µ–ª—ã–π</button>
            </div>
            
            <div class="calendar-grid" id="calendarGrid">
                <!-- –ö–∞–ª–µ–Ω–¥–∞—Ä—å –±—É–¥–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
            
            <div class="calendar-actions">
                <button class="create-event-btn" onclick="openCreateEventModal()">+ –°–æ–∑–¥–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ</button>
            </div>
        </div>
    </div>

    <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–æ–µ–∫—Ç–Ω–æ–π –¥–æ—Å–∫–∏ -->
    <div id="project-board-page" class="page">
        <div class="page-header">
            <h1>üìã –ü—Ä–æ–µ–∫—Ç–Ω—ã–π –ü–ª–∞–Ω</h1>
            <p>–î–æ—Å–∫–∞ –∑–∞–¥–∞—á –∏ —Å—Ç–∞—Ç—É—Å–æ–≤</p>
        </div>
        
        <div class="project-board" id="projectBoard">
            <!-- –°—Ç–æ–ª–±—Ü—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —Ö–æ—Å—Ç–æ–º -->
        </div>
        
        <button class="add-task-btn" onclick="openTaskModal()">+ –î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É</button>
    </div>

    <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ —á–∞—Ç–∞ -->
    <div id="chat-page" class="page">
        <div class="page-header">
            <h1>üí¨ –°–≤—è–∑—å</h1>
            <p>–û–±—â–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã</p>
        </div>
        
        <div class="chat-container">
            <div class="chat-messages" id="chatMessages">
                <!-- –°–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
            
            <div class="chat-input">
                <input type="text" id="chatInput" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ...">
                <button onclick="sendMessage()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∫–∞–±–∏–Ω–µ—Ç–∞ —Ö–æ—Å—Ç–∞ -->
    <div id="host-cabinet-page" class="page">
        <div class="page-header">
            <h1>üëë –ö–∞–±–∏–Ω–µ—Ç –•–æ—Å—Ç–∞</h1>
            <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–æ–ª—è–º–∏ –∏ –ø—Ä–æ–µ–∫—Ç–æ–º</p>
        </div>
        
        <div class="host-controls">
            <div class="control-section">
                <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</h3>
                <div class="user-list" id="userList">
                    <!-- –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±—É–¥–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
            </div>
            
            <div class="control-section">
                <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞–º–∏ –∑–∞–¥–∞—á</h3>
                <button onclick="openCreateStatusModal()">+ –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å</button>
                <div id="statusList" style="margin-top: 1rem;">
                    <!-- –°–ø–∏—Å–æ–∫ —Å—Ç–∞—Ç—É—Å–æ–≤ –±—É–¥–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
            </div>
            
            <div class="control-section">
                <h3>–°—Å—ã–ª–∫–∞ –¥–ª—è –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è</h3>
                <div style="display: flex; gap: 0.5rem;">
                    <input type="text" id="inviteLink" value="https://proekt.top/invite/abc123" readonly style="flex: 1;">
                    <button onclick="copyInviteLink()">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—Ö–æ–¥–∞ -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeLoginModal()">&times;</span>
            <h2>–í—Ö–æ–¥ –≤ Proekt.top</h2>
            <form id="loginForm">
                <div class="form-group">
                    <input type="email" placeholder="–ü–æ—á—Ç–∞" required id="loginEmail">
                </div>
                <div class="form-group">
                    <input type="password" placeholder="–ü–∞—Ä–æ–ª—å" required id="loginPassword">
                </div>
                <button type="submit">–í–æ–π—Ç–∏</button>
            </form>
            <div class="switch-form">
                <p>–ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? <a onclick="switchToRegister()">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</a></p>
            </div>
            <p id="loginMessage" class="message"></p>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
    <div id="registerModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeRegisterModal()">&times;</span>
            <h2>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ Proekt.top</h2>
            <form id="registerForm">
                <div class="form-group">
                    <input type="text" placeholder="–ò–º—è" required id="regName">
                </div>
                <div class="form-group">
                    <input type="email" placeholder="–ü–æ—á—Ç–∞" required id="regEmail">
                </div>
                <div class="form-group">
                    <input type="password" placeholder="–ü–∞—Ä–æ–ª—å" required id="regPassword">
                </div>
                <div class="form-group">
                    <input type="password" placeholder="–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å" required id="regConfirmPassword">
                </div>
                <div class="form-group">
                    <label>–í—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–ª—å:</label>
                    <div class="role-selection" id="roleSelection">
                        <div class="role-option" onclick="selectRole('member')">
                            <input type="radio" name="role" value="member" class="role-radio" id="roleMember">
                            <div class="role-info">
                                <div class="role-name">–£—á–∞—Å—Ç–Ω–∏–∫</div>
                            </div>
                        </div>
                        <div class="role-option" onclick="selectRole('host')">
                            <input type="radio" name="role" value="host" class="role-radio" id="roleHost">
                            <div class="role-info">
                                <div class="role-name">–•–æ—Å—Ç</div>
                            </div>
                        </div>
                    </div>
                    <input type="hidden" id="regRole" value="member">
                </div>
                <button type="submit">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
            </form>
            <div class="switch-form">
                <p>–£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? <a onclick="switchToLogin()">–í–æ–π—Ç–∏</a></p>
            </div>
            <p id="registerMessage" class="message"></p>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è —Å–æ–±—ã—Ç–∏—è -->
    <div id="createEventModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeCreateEventModal()">&times;</span>
            <h2>–°–æ–∑–¥–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ</h2>
            <form id="createEventForm">
                <div class="form-group">
                    <input type="text" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è" required id="eventTitle">
                </div>
                <div class="form-group">
                    <textarea placeholder="–û–ø–∏—Å–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è" rows="3" id="eventDescription"></textarea>
                </div>
                <div class="form-group">
                    <input type="date" id="eventDate" required>
                </div>
                <div class="form-group">
                    <input type="time" id="eventTime" required>
                </div>
                <button type="submit">–°–æ–∑–¥–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ</button>
            </form>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∑–∞–¥–∞—á–∏ -->
    <div id="taskModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeTaskModal()">&times;</span>
            <h2>–ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞</h2>
            <form id="taskForm">
                <div class="form-group">
                    <input type="text" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏" required id="taskTitle">
                </div>
                <div class="form-group">
                    <textarea placeholder="–û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏" rows="3" id="taskDescription"></textarea>
                </div>
                <div class="form-group">
                    <select id="taskStatus">
                        <!-- –°—Ç–∞—Ç—É—Å—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </select>
                </div>
                <button type="submit">–°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É</button>
            </form>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ -->
    <div id="createStatusModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeCreateStatusModal()">&times;</span>
            <h2>–°–æ–∑–¥–∞—Ç—å —Å—Ç–∞—Ç—É—Å</h2>
            <form id="createStatusForm">
                <div class="form-group">
                    <input type="text" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞" required id="statusName">
                </div>
                <div class="form-group">
                    <input type="color" value="#ffeb3b" id="statusColor">
                </div>
                <button type="submit">–°–æ–∑–¥–∞—Ç—å —Å—Ç–∞—Ç—É—Å</button>
            </form>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–±—ã—Ç–∏—è -->
    <div id="eventModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeEventModal()">&times;</span>
            <h2>–°–æ–±—ã—Ç–∏–µ –∫–∞–ª–µ–Ω–¥–∞—Ä—è</h2>
            <div id="eventDetails">
                <!-- –î–µ—Ç–∞–ª–∏ —Å–æ–±—ã—Ç–∏—è –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∑–¥–µ—Å—å -->
            </div>
        </div>
    </div>

    <script>
        // –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤ (–∫–∞–∂–¥—ã–π —Ö–æ—Å—Ç –∏–º–µ–µ—Ç —Å–≤–æ–π –ø—Ä–æ–µ–∫—Ç)
        let projects = JSON.parse(localStorage.getItem('proekt_top_projects')) || {};
        let currentProjectId = localStorage.getItem('proekt_top_currentProjectId') || 'default';
        
        // –ï—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–µ—Ç, —Å–æ–∑–¥–∞–µ–º –µ–≥–æ
        if (!projects[currentProjectId]) {
            projects[currentProjectId] = {
                users: {
                    'host@proekt.top': { password: 'host123', role: 'host', name: '–ê–ª–µ–∫—Å–µ–π' }
                },
                currentUser: null,
                statuses: [],
                events: [],
                tasks: [],
                inviteCode: generateInviteCode()
            };
            saveData();
        }

        let currentProject = projects[currentProjectId];
        let users = currentProject.users;
        let currentUser = currentProject.currentUser;
        let calendarColorMode = 'color';
        let currentDate = new Date();
        let statuses = currentProject.statuses;
        let events = currentProject.events;
        let tasks = currentProject.tasks;

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è
        function generateInviteCode() {
            return Math.random().toString(36).substring(2, 8).toUpperCase();
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ localStorage
        function saveData() {
            localStorage.setItem('proekt_top_projects', JSON.stringify(projects));
            localStorage.setItem('proekt_top_currentProjectId', currentProjectId);
        }

        // –°–º–µ–Ω–∞ –ø—Ä–æ–µ–∫—Ç–∞ –ø–æ –ø—Ä–∏–≥–ª–∞—Å–∏—Ç–µ–ª—å–Ω–æ–π —Å—Å—ã–ª–∫–µ
        function joinProject(inviteCode) {
            const project = Object.values(projects).find(p => p.inviteCode === inviteCode);
            if (project) {
                const projectId = Object.keys(projects).find(id => projects[id] === project);
                currentProjectId = projectId;
                currentProject = project;
                users = project.users;
                statuses = project.statuses;
                events = project.events;
                tasks = project.tasks;
                saveData();
                return true;
            }
            return false;
        }

        // –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            document.getElementById(`${pageId}-page`).classList.add('active');
            
            const navBack = document.getElementById('navBack');
            if (pageId === 'home') {
                navBack.style.display = 'none';
            } else {
                navBack.style.display = 'block';
            }
            
            if (pageId === 'host-cabinet' && currentUser && currentUser.role !== 'host') {
                alert('–î–æ—Å—Ç—É–ø –∫ –∫–∞–±–∏–Ω–µ—Ç—É —Ö–æ—Å—Ç–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —Ä–æ–ª—å—é "–•–æ—Å—Ç"');
                showPage('home');
                return;
            }
            
            const protectedPages = ['project-board', 'chat', 'host-cabinet'];
            if (protectedPages.includes(pageId) && !currentUser) {
                alert('–î–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É');
                openLoginModal();
                showPage('home');
                return;
            }

            // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            if (pageId === 'calendar') {
                updateCalendar();
            } else if (pageId === 'project-board') {
                updateProjectBoard();
                initDragAndDrop();
            } else if (pageId === 'host-cabinet') {
                updateHostCabinet();
            } else if (pageId === 'chat') {
                updateChat();
            }
        }

        // –§—É–Ω–∫—Ü–∏–∏ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
        function openLoginModal() {
            closeRegisterModal();
            document.getElementById('loginModal').style.display = 'block';
        }

        function closeLoginModal() {
            document.getElementById('loginModal').style.display = 'none';
            document.getElementById('loginForm').reset();
            document.getElementById('loginMessage').textContent = '';
        }

        function openRegisterModal() {
            closeLoginModal();
            document.getElementById('registerModal').style.display = 'block';
            selectRole('member');
        }

        function closeRegisterModal() {
            document.getElementById('registerModal').style.display = 'none';
            document.getElementById('registerForm').reset();
            document.getElementById('registerMessage').textContent = '';
        }

        function switchToRegister() {
            closeLoginModal();
            openRegisterModal();
        }

        function switchToLogin() {
            closeRegisterModal();
            openLoginModal();
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ä–æ–ª–∏
        function selectRole(role) {
            document.querySelectorAll('.role-option').forEach(option => {
                option.classList.remove('selected');
            });
            
            const selectedOption = document.querySelector(`.role-option input[value="${role}"]`).closest('.role-option');
            selectedOption.classList.add('selected');
            
            document.getElementById('regRole').value = role;
            
            document.querySelectorAll('.role-radio').forEach(radio => {
                radio.checked = radio.value === role;
            });
        }

        function openCreateEventModal() {
            document.getElementById('createEventModal').style.display = 'block';
        }

        function closeCreateEventModal() {
            document.getElementById('createEventModal').style.display = 'none';
        }

        function openTaskModal() {
            updateTaskStatusSelect();
            document.getElementById('taskModal').style.display = 'block';
        }

        function closeTaskModal() {
            document.getElementById('taskModal').style.display = 'none';
        }

        function openCreateStatusModal() {
            document.getElementById('createStatusModal').style.display = 'block';
        }

        function closeCreateStatusModal() {
            document.getElementById('createStatusModal').style.display = 'none';
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —Å–æ–±—ã—Ç–∏—è
        function openEventModal(day) {
            const dayEvents = events.filter(event => {
                const eventDate = new Date(event.date);
                return eventDate.getDate() === day && 
                       eventDate.getMonth() === currentDate.getMonth() && 
                       eventDate.getFullYear() === currentDate.getFullYear();
            });

            if (dayEvents.length > 0) {
                let eventsHTML = '';
                dayEvents.forEach(event => {
                    const eventDate = new Date(event.date);
                    eventsHTML += `
                        <div style="margin-bottom: 1rem; padding: 1rem; background: #111; border-radius: 8px; border: 1px solid #ffeb3b;">
                            <h3>${event.title}</h3>
                            <p><strong>–û–ø–∏—Å–∞–Ω–∏–µ:</strong> ${event.description}</p>
                            <p><strong>–í—Ä–µ–º—è:</strong> ${eventDate.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</p>
                            <p><strong>–°–æ–∑–¥–∞–ª:</strong> ${users[event.createdBy]?.name || event.createdBy}</p>
                        </div>
                    `;
                });

                document.getElementById('eventDetails').innerHTML = `
                    <h3>–°–æ–±—ã—Ç–∏—è –Ω–∞ ${day} ${getMonthName(currentDate.getMonth())} ${currentDate.getFullYear()}</h3>
                    ${eventsHTML}
                `;
                document.getElementById('eventModal').style.display = 'block';
            } else {
                alert('–ù–∞ —ç—Ç–æ—Ç –¥–µ–Ω—å –Ω–µ—Ç —Å–æ–±—ã—Ç–∏–π');
            }
        }

        function closeEventModal() {
            document.getElementById('eventModal').style.display = 'none';
        }

        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–∞–∑–≤–∞–Ω–∏—è –º–µ—Å—è—Ü–∞
        function getMonthName(monthIndex) {
            const monthNames = ["—è–Ω–≤–∞—Ä—è", "—Ñ–µ–≤—Ä–∞–ª—è", "–º–∞—Ä—Ç–∞", "–∞–ø—Ä–µ–ª—è", "–º–∞—è", "–∏—é–Ω—è", 
                               "–∏—é–ª—è", "–∞–≤–≥—É—Å—Ç–∞", "—Å–µ–Ω—Ç—è–±—Ä—è", "–æ–∫—Ç—è–±—Ä—è", "–Ω–æ—è–±—Ä—è", "–¥–µ–∫–∞–±—Ä—è"];
            return monthNames[monthIndex];
        }

        // –ö–∞–ª–µ–Ω–¥–∞—Ä—å
        function updateCalendar() {
            const monthNames = ["–Ø–Ω–≤–∞—Ä—å", "–§–µ–≤—Ä–∞–ª—å", "–ú–∞—Ä—Ç", "–ê–ø—Ä–µ–ª—å", "–ú–∞–π", "–ò—é–Ω—å", "–ò—é–ª—å", "–ê–≤–≥—É—Å—Ç", "–°–µ–Ω—Ç—è–±—Ä—å", "–û–∫—Ç—è–±—Ä—å", "–ù–æ—è–±—Ä—å", "–î–µ–∫–∞–±—Ä—å"];
            document.getElementById('currentMonth').textContent = `${monthNames[currentDate.getMonth()]} ${currentDate.getFullYear()}`;
            
            const calendarGrid = document.getElementById('calendarGrid');
            calendarGrid.innerHTML = '';
            
            // –ó–∞–≥–æ–ª–æ–≤–∫–∏ –¥–Ω–µ–π –Ω–µ–¥–µ–ª–∏
            const dayNames = ['–ü–Ω', '–í—Ç', '–°—Ä', '–ß—Ç', '–ü—Ç', '–°–±', '–í—Å'];
            dayNames.forEach(day => {
                const dayHeader = document.createElement('div');
                dayHeader.className = 'calendar-day-header';
                dayHeader.textContent = day;
                calendarGrid.appendChild(dayHeader);
            });
            
            // –î–Ω–∏ –º–µ—Å—è—Ü–∞
            const firstDay = new Date(currentDate.getFullYear(), currentDate.getMonth(), 1);
            const lastDay = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 0);
            
            // –ü—É—Å—Ç—ã–µ —è—á–µ–π–∫–∏ –ø–µ—Ä–µ–¥ –ø–µ—Ä–≤—ã–º –¥–Ω–µ–º
            for (let i = 0; i < (firstDay.getDay() + 6) % 7; i++) {
                const emptyDay = document.createElement('div');
                emptyDay.className = 'calendar-day';
                calendarGrid.appendChild(emptyDay);
            }
            
            // –î–Ω–∏ –º–µ—Å—è—Ü–∞
            for (let day = 1; day <= lastDay.getDate(); day++) {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day';
                dayElement.textContent = day;
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –µ—Å—Ç—å –ª–∏ —Å–æ–±—ã—Ç–∏—è –Ω–∞ —ç—Ç–æ—Ç –¥–µ–Ω—å
                const hasEvent = events.some(event => {
                    const eventDate = new Date(event.date);
                    return eventDate.getDate() === day && 
                           eventDate.getMonth() === currentDate.getMonth() && 
                           eventDate.getFullYear() === currentDate.getFullYear();
                });
                
                if (hasEvent) {
                    dayElement.classList.add('has-event');
                }
                
                dayElement.onclick = () => openEventModal(day);
                calendarGrid.appendChild(dayElement);
            }
        }

        function changeMonth(direction) {
            currentDate.setMonth(currentDate.getMonth() + direction);
            updateCalendar();
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–º—ã –∫–∞–ª–µ–Ω–¥–∞—Ä—è
        function toggleCalendarTheme() {
            const calendar = document.querySelector('.calendar-container');
            const button = document.querySelector('.calendar-theme-toggle');
            
            if (calendarColorMode === 'color') {
                calendar.style.filter = 'grayscale(100%)';
                button.textContent = '–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –Ω–∞ —Ü–≤–µ—Ç–Ω–æ–π';
                calendarColorMode = 'grayscale';
            } else {
                calendar.style.filter = 'grayscale(0%)';
                button.textContent = '–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –Ω–∞ —á–µ—Ä–Ω–æ-–±–µ–ª—ã–π';
                calendarColorMode = 'color';
            }
        }

        // –ß–∞—Ç
        function updateChat() {
            const messagesContainer = document.getElementById('chatMessages');
            messagesContainer.innerHTML = '';
            
            // –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            const welcomeMessage = document.createElement('div');
            welcomeMessage.className = 'message';
            welcomeMessage.innerHTML = `
                <div class="message-header">
                    <span>üí¨ –°–∏—Å—Ç–µ–º–∞</span>
                    <span>${new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</span>
                </div>
                <div class="message-text">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –æ–±—â–∏–π —á–∞—Ç –ø—Ä–æ–µ–∫—Ç–∞!</div>
            `;
            messagesContainer.appendChild(welcomeMessage);
        }

        function sendMessage() {
            const input = document.getElementById('chatInput');
            const messagesContainer = document.getElementById('chatMessages');
            
            if (input.value.trim() === '') return;
            
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message';
            
            const userName = currentUser ? currentUser.name : '–ì–æ—Å—Ç—å';
            
            messageDiv.innerHTML = `
                <div class="message-header">
                    <span>${userName}</span>
                    <span>${new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</span>
                </div>
                <div class="message-text">${input.value}</div>
            `;
            
            messagesContainer.appendChild(messageDiv);
            input.value = '';
            
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        // –ü—Ä–æ–µ–∫—Ç–Ω–∞—è –¥–æ—Å–∫–∞
        function updateProjectBoard() {
            const projectBoard = document.getElementById('projectBoard');
            projectBoard.innerHTML = '';
            
            statuses.forEach(status => {
                const statusColumn = document.createElement('div');
                statusColumn.className = 'status-column';
                statusColumn.style.borderColor = status.color;
                statusColumn.dataset.status = status.name;
                
                const statusHeader = document.createElement('div');
                statusHeader.className = 'status-header';
                statusHeader.innerHTML = `<h3>${status.name}</h3>`;
                
                statusColumn.appendChild(statusHeader);
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–¥–∞—á–∏ –¥–ª—è —ç—Ç–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞
                const statusTasks = tasks.filter(task => task.status === status.name);
                statusTasks.forEach((task, index) => {
                    const taskElement = document.createElement('div');
                    taskElement.className = 'task';
                    taskElement.draggable = true;
                    taskElement.dataset.taskIndex = tasks.indexOf(task);
                    taskElement.innerHTML = `
                        <h4>${task.title}</h4>
                        <p>${task.description}</p>
                        <div class="task-date">–ü–µ—Ä–µ–Ω–µ—Å–µ–Ω–æ: ${new Date(task.lastMoved || task.createdAt).toLocaleDateString()}</div>
                    `;
                    statusColumn.appendChild(taskElement);
                });
                
                projectBoard.appendChild(statusColumn);
            });
        }

        function initDragAndDrop() {
            const taskElements = document.querySelectorAll('.task');
            const columns = document.querySelectorAll('.status-column');
            
            taskElements.forEach(task => {
                task.addEventListener('dragstart', (e) => {
                    e.dataTransfer.setData('text/plain', task.dataset.taskIndex);
                    task.classList.add('dragging');
                });
                
                task.addEventListener('dragend', () => {
                    task.classList.remove('dragging');
                });
            });
            
            columns.forEach(column => {
                column.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    column.style.backgroundColor = '#1a1a1a';
                });
                
                column.addEventListener('dragleave', () => {
                    column.style.backgroundColor = '';
                });
                
                column.addEventListener('drop', (e) => {
                    e.preventDefault();
                    column.style.backgroundColor = '';
                    const taskIndex = e.dataTransfer.getData('text/plain');
                    const newStatus = column.dataset.status;
                    
                    if (taskIndex && newStatus) {
                        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á–∏
                        tasks[taskIndex].status = newStatus;
                        tasks[taskIndex].lastMoved = new Date().toISOString();
                        
                        saveData();
                        updateProjectBoard();
                        initDragAndDrop();
                    }
                });
            });
        }

        function updateTaskStatusSelect() {
            const select = document.getElementById('taskStatus');
            select.innerHTML = '';
            
            statuses.forEach(status => {
                const option = document.createElement('option');
                option.value = status.name;
                option.textContent = status.name;
                select.appendChild(option);
            });
        }

        // –ö–∞–±–∏–Ω–µ—Ç —Ö–æ—Å—Ç–∞
        function updateHostCabinet() {
            updateUserList();
            updateStatusList();
            updateInviteLink();
        }

        function updateUserList() {
            const userList = document.getElementById('userList');
            userList.innerHTML = '';
            
            Object.entries(users).forEach(([email, user]) => {
                if (user.role !== 'host') {
                    const userCard = document.createElement('div');
                    userCard.className = 'user-card';
                    userCard.innerHTML = `
                        <div class="user-info-line">
                            <button onclick="removeUser('${email}')">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
                            <span><strong>${user.name}</strong> (${email})</span>
                            <select class="role-select" onchange="changeUserRole('${email}', this.value)">
                                <option value="member" ${user.role === 'member' ? 'selected' : ''}>–£—á–∞—Å—Ç–Ω–∏–∫</option>
                                <option value="moderator" ${user.role === 'moderator' ? 'selected' : ''}>–ú–æ–¥–µ—Ä–∞—Ç–æ—Ä</option>
                            </select>
                        </div>
                    `;
                    userList.appendChild(userCard);
                }
            });
        }

        function updateStatusList() {
            const statusList = document.getElementById('statusList');
            statusList.innerHTML = '';
            
            statuses.forEach((status, index) => {
                const statusItem = document.createElement('div');
                statusItem.className = 'user-card';
                statusItem.innerHTML = `
                    <div class="user-info-line">
                        <span><strong>${status.name}</strong></span>
                        <button onclick="removeStatus(${index})">–£–¥–∞–ª–∏—Ç—å</button>
                    </div>
                `;
                statusList.appendChild(statusItem);
            });
        }

        function updateInviteLink() {
            document.getElementById('inviteLink').value = `https://proekt.top/join/${currentProject.inviteCode}`;
        }

        function changeUserRole(email, newRole) {
            users[email].role = newRole;
            saveData();
            updateHostCabinet();
        }

        function removeUser(email) {
            if (confirm(`–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${email}?`)) {
                delete users[email];
                saveData();
                updateHostCabinet();
            }
        }

        function removeStatus(index) {
            if (confirm(`–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ç—É—Å "${statuses[index].name}"?`)) {
                statuses.splice(index, 1);
                saveData();
                updateHostCabinet();
                updateProjectBoard();
            }
        }

        function copyInviteLink() {
            const inviteLink = document.getElementById('inviteLink');
            inviteLink.select();
            document.execCommand('copy');
            alert('–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!');
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥–∞
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            if (users[email] && users[email].password === password) {
                currentUser = { 
                    email, 
                    role: users[email].role,
                    name: users[email].name
                };
                currentProject.currentUser = currentUser;
                document.getElementById('loginMessage').textContent = '–£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥!';
                document.getElementById('loginMessage').style.color = '#4caf50';
                
                updateUIForUser();
                saveData();
                
                setTimeout(() => {
                    closeLoginModal();
                }, 1000);
                
            } else {
                document.getElementById('loginMessage').textContent = '–ù–µ–≤–µ—Ä–Ω–∞—è –ø–æ—á—Ç–∞ –∏–ª–∏ –ø–∞—Ä–æ–ª—å!';
                document.getElementById('loginMessage').style.color = '#ff5252';
            }
        });

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
        document.getElementById('registerForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const name = document.getElementById('regName').value;
            const email = document.getElementById('regEmail').value;
            const password = document.getElementById('regPassword').value;
            const confirmPassword = document.getElementById('regConfirmPassword').value;
            const role = document.getElementById('regRole').value;
            
            const messageEl = document.getElementById('registerMessage');
            
            if (password !== confirmPassword) {
                messageEl.textContent = '–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç!';
                messageEl.style.color = '#ff5252';
                return;
            }
            
            if (users[email]) {
                messageEl.textContent = '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–æ–π –ø–æ—á—Ç–æ–π —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç!';
                messageEl.style.color = '#ff5252';
                return;
            }
            
            users[email] = {
                password: password,
                role: role,
                name: name
            };
            
            messageEl.textContent = '–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ!';
            messageEl.style.color = '#4caf50';
            
            setTimeout(() => {
                currentUser = { 
                    email, 
                    role: role,
                    name: name
                };
                currentProject.currentUser = currentUser;
                
                updateUIForUser();
                saveData();
                closeRegisterModal();
            }, 1500);
        });

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Å–æ–±—ã—Ç–∏—è
        document.getElementById('createEventForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const title = document.getElementById('eventTitle').value;
            const description = document.getElementById('eventDescription').value;
            const date = document.getElementById('eventDate').value;
            const time = document.getElementById('eventTime').value;
            
            events.push({
                title,
                description,
                date: `${date}T${time}`,
                createdBy: currentUser.email
            });
            
            saveData();
            updateCalendar();
            closeCreateEventModal();
            alert('–°–æ–±—ã—Ç–∏–µ —Å–æ–∑–¥–∞–Ω–æ!');
        });

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á–∏
        document.getElementById('taskForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const title = document.getElementById('taskTitle').value;
            const description = document.getElementById('taskDescription').value;
            const status = document.getElementById('taskStatus').value;
            
            tasks.push({
                title,
                description,
                status,
                createdBy: currentUser.email,
                createdAt: new Date().toISOString(),
                lastMoved: new Date().toISOString()
            });
            
            saveData();
            updateProjectBoard();
            initDragAndDrop();
            closeTaskModal();
            alert('–ó–∞–¥–∞—á–∞ —Å–æ–∑–¥–∞–Ω–∞!');
        });

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞
        document.getElementById('createStatusForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const name = document.getElementById('statusName').value;
            const color = document.getElementById('statusColor').value;
            
            statuses.push({
                name,
                color,
                createdBy: currentUser.email
            });
            
            saveData();
            updateHostCabinet();
            updateProjectBoard();
            closeCreateStatusModal();
            alert('–°—Ç–∞—Ç—É—Å —Å–æ–∑–¥–∞–Ω!');
        });

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–æ–ª–∏
        function updateUIForUser() {
            const authSection = document.getElementById('authSection');
            const hostCabinetLink = document.getElementById('hostCabinetLink');
            
            if (currentUser) {
                authSection.innerHTML = `
                    <div class="user-info">
                        <span>${currentUser.name}</span>
                        <span class="user-role">${getRoleName(currentUser.role)}</span>
                        <button onclick="logout()">–í—ã–π—Ç–∏</button>
                    </div>
                `;
                
                if (currentUser.role === 'host') {
                    hostCabinetLink.style.display = 'block';
                } else {
                    hostCabinetLink.style.display = 'none';
                }
            } else {
                authSection.innerHTML = `
                    <div class="auth-buttons">
                        <button onclick="openRegisterModal()">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
                        <button onclick="openLoginModal()">–í–æ–π—Ç–∏</button>
                    </div>
                `;
                hostCabinetLink.style.display = 'none';
            }
        }

        // –ü–æ–ª—É—á–µ–Ω–∏–µ —á–∏—Ç–∞–µ–º–æ–≥–æ –Ω–∞–∑–≤–∞–Ω–∏—è —Ä–æ–ª–∏
        function getRoleName(role) {
            const roleNames = {
                'host': '–•–æ—Å—Ç',
                'moderator': '–ú–æ–¥–µ—Ä–∞—Ç–æ—Ä',
                'member': '–£—á–∞—Å—Ç–Ω–∏–∫'
            };
            return roleNames[role] || role;
        }

        // –í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã
        function logout() {
            currentUser = null;
            currentProject.currentUser = null;
            updateUIForUser();
            saveData();
            showPage('home');
            alert('–í—ã –≤—ã—à–ª–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã');
        }

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –∏—Ö
        window.onclick = function(event) {
            const modals = ['loginModal', 'registerModal', 'createEventModal', 'taskModal', 'createStatusModal', 'eventModal'];
            
            modals.forEach(modalId => {
                const modal = document.getElementById(modalId);
                if (event.target === modal) {
                    if (modalId === 'loginModal') closeLoginModal();
                    if (modalId === 'registerModal') closeRegisterModal();
                    if (modalId === 'createEventModal') closeCreateEventModal();
                    if (modalId === 'taskModal') closeTaskModal();
                    if (modalId === 'createStatusModal') closeCreateStatusModal();
                    if (modalId === 'eventModal') closeEventModal();
                }
            });
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏—è Enter –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞ —á–∞—Ç–∞
        document.getElementById('chatInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            selectRole('member');
            updateUIForUser();
            updateCalendar();
            updateChat();
            updateInviteLink();
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏–≥–ª–∞—Å–∏—Ç–µ–ª—å–Ω–æ–π —Å—Å—ã–ª–∫–∏ –≤ URL
            const urlParams = new URLSearchParams(window.location.search);
            const inviteCode = urlParams.get('invite');
            if (inviteCode && joinProject(inviteCode)) {
                alert('–í—ã –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª–∏—Å—å –∫ –ø—Ä–æ–µ–∫—Ç—É!');
                updateUIForUser();
            }
        });
    </script>
</body>
</html>